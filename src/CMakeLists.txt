# SPDX-FileCopyrightText: (C) 2020 Carl Schwan <carl@carlschwan.eu>
#
# SPDX-License-Identifier: BSD-2-Clause

set(kalendar_SRCS
    about.cpp
    main.cpp
    agentconfiguration.cpp
    incidenceoccurrencemodel.cpp
    calendarmanager.cpp
    multidayincidencemodel.cpp
    incidencewrapper.cpp
    remindersmodel.cpp
    attendeesmodel.cpp
    recurrenceexceptionsmodel.cpp
    attachmentsmodel.cpp
    contactsmanager.cpp
    todomodel.cpp
    incidencetreemodel.cpp
    todosortfilterproxymodel.cpp
    kalendarapplication.cpp
    itemtagsmodel.cpp
    tagmanager.cpp
    extratodomodel.cpp
    actionsmodel.cpp
    commandbarfiltermodel.cpp
    hourlyincidencemodel.cpp
    timezonelistmodel.cpp
    monthmodel.cpp
    infinitecalendarviewmodel.cpp
    resources.qrc)

add_executable(kalendar ${kalendar_SRCS})

target_link_libraries(kalendar
    Qt5::Core
    Qt5::Gui
    Qt5::Qml
    Qt5::Quick
    Qt5::QuickControls2
    Qt5::QuickWidgets
    Qt5::Svg
    Qt5::Location
    KF5::I18n
    KF5::CoreAddons
    KF5::CalendarCore
    KF5::AkonadiCore
    KF5::AkonadiContact
    KF5::AkonadiAgentBase
    KF5::AkonadiXml
    KF5::CalendarSupport
    KF5::WindowSystem
    KF5::ConfigWidgets
    KF5::AkonadiWidgets
    KF5::People
    KF5::Contacts
    KF5::ItemModels
    KF5::XmlGui
    KF5::EventViews # for reading KOrganizer calendar colors
    KF5::KontactInterface
)
kconfig_add_kcfg_files(kalendar GENERATE_MOC kalendarconfig.kcfgc)
install(TARGETS kalendar ${KF5_INSTALL_TARGETS_DEFAULT_ARGS})




set(kalendarpart_PART_SRCS kalendar_part.cpp ${kalendar_SRCS})
qt_generate_dbus_interface(kalendar_part.h org.kde.kalendar.part.xml OPTIONS -a)
qt_add_dbus_adaptor(kalendarpart_PART_SRCS
    ${kalendar_SOURCE_DIR}/src/org.kde.kalendar.part.xml kalendar_part.h KalendarPart
)
qt_add_dbus_interfaces(kalendarpart_PART_SRCS ${kalendar_SOURCE_DIR}/src/org.kde.kalendar.part.xml)
add_library(kalendarpart MODULE ${kalendarpart_PART_SRCS})

kconfig_add_kcfg_files(kalendarpart GENERATE_MOC kalendarconfig.kcfgc)
kcoreaddons_desktop_to_json(kalendarpart ${kalendar_SOURCE_DIR}/src/kalendar_part.desktop)

target_link_libraries(kalendarpart
    Qt5::Core
    Qt5::Gui
    Qt5::Qml
    Qt5::Quick
    Qt5::QuickControls2
    Qt5::QuickWidgets
    Qt5::Svg
    Qt5::Location
    KF5::I18n
    KF5::CoreAddons
    KF5::CalendarCore
    KF5::AkonadiCore
    KF5::AkonadiContact
    KF5::AkonadiAgentBase
    KF5::AkonadiXml
    KF5::CalendarSupport
    KF5::WindowSystem
    KF5::ConfigWidgets
    KF5::AkonadiWidgets
    KF5::People
    KF5::Contacts
    KF5::ItemModels
    KF5::XmlGui
    KF5::EventViews # for reading KOrganizer calendar colors
    KF5::KontactInterface
)

install(TARGETS
    kalendarpart
    DESTINATION ${KDE_INSTALL_PLUGINDIR}/kf5/parts/
)

install(FILES
    kalendar_part.desktop
    DESTINATION ${KDE_INSTALL_KSERVICES5DIR}
    )


install(FILES ${kalendar_SOURCE_DIR}/src/org.kde.kalendar.part.xml DESTINATION ${KDE_INSTALL_DBUSINTERFACEDIR})

add_subdirectory(kontactplugin)

